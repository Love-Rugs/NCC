---
import type { CollectionEntry } from "astro:content";

interface Props {
  teamScope: "2017s" | "2018s" | "2019s" | "2020s";
  items: CollectionEntry<"news">[];
}

const { teamScope, items } = Astro.props;
const filtered = items
  .filter((item) => item.data.teamScopes.includes(teamScope) || item.data.teamScopes.includes("club"))
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 4);
---

<div class="grid two">
  {
    filtered.length ? (
      filtered.map((item) => (
        <article class="card card-news reveal">
          <p class="muted">{item.data.publishDate.toLocaleDateString("en-GB")}</p>
          <h3>{item.data.title}</h3>
          <p>{item.data.summary}</p>
          <div class="chips">
            {item.data.teamScopes.map((scope) => <span class="chip">{scope}</span>)}
          </div>
          <a href={`/news/${item.slug}`}>Read update</a>
        </article>
      ))
    ) : (
      <article class="card"><p>No updates for this team yet.</p></article>
    )
  }
</div>
